// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
 // provider = "prisma-client"
 provider = "prisma-client-js"

  //output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
 // url      = env("DATABASE_URL")
  url      = "mysql://root@localhost:3306/app-queenbeekitchen"
}


model m_role {
  id          Int       @id @default(autoincrement())
  name        String    @unique         // e.g. "ADMIN", "USER", "SUPERADMIN"
  description String?                   // short explanation of role purpose
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  createdBy   Int
  updatedBy   Int
  delFlag     Boolean   @default(false)

  users       m_user[]                     // 1 Role â†’ Many Users
}


model m_user {
  id         Int       @id @default(autoincrement())
  sso_id     String    @unique
  sso_type   String
  isBlocked  Boolean   @default(false)
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  createdBy Int
  updatedBy Int
  // Relationship to Role
  roleId     Int
  role       m_role    @relation(fields: [roleId], references: [id])

   // ðŸ‘‡ Add reverse relation fields
  cuisinesCreated m_cuisine[] @relation("CuisineCreatedBy")
  cuisinesUpdated m_cuisine[] @relation("CuisineUpdatedBy")
  categoriesCreated m_category[] @relation("CategoryCreatedBy")
  categoriesUpdated m_category[] @relation("CategoryUpdatedBy")
  languagesCreated m_language[] @relation("LanguageCreatedBy")
  languagesUpdated m_language[] @relation("LanguageUpdatedBy")
  foodTypesCreated m_food_type[] @relation("FoodTypeCreatedBy")
  foodTypesUpdated m_food_type[] @relation("FoodTypeUpdatedBy")
  recipesCreated m_recipe[] @relation("RecipeCreatedBy")
  recipesUpdated m_recipe[] @relation("RecipeUpdatedBy")
  recipeDetailsCreated m_recipe_details[] @relation("RecipeDetailsCreatedBy")
  recipeDetailsUpdated m_recipe_details[] @relation("RecipeDetailsUpdatedBy")
}


model m_cuisine {
  id           Int       @id @default(autoincrement())
  name         String    @unique @db.VarChar(100)
  description  String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  delFlag      Boolean   @default(false)

  createdBy  Int
  updatedBy  Int

  // ðŸ‘‡ Foreign key relations to User table
  createdByUser   m_user     @relation("CuisineCreatedBy", fields: [createdBy], references: [id])
  updatedByUser    m_user     @relation("CuisineUpdatedBy", fields: [updatedBy], references: [id])
  // ðŸ‘‡ Reverse relation to Recipes
  recipes       m_recipe[]
}


model m_category {
  id           Int       @id @default(autoincrement())
  name         String    @unique @db.VarChar(100)
  description  String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  delFlag      Boolean   @default(false)

  createdBy    Int
  updatedBy    Int

  // ðŸ‘‡ Foreign key relations to User table
  createdByUser   m_user     @relation("CategoryCreatedBy", fields: [createdBy], references: [id])
  updatedByUser  m_user     @relation("CategoryUpdatedBy", fields: [updatedBy], references: [id])
    // ðŸ‘‡ Reverse relation to Recipes
  recipes       m_recipe[]

}

model m_language {
  id           Int       @id @default(autoincrement())
  name         String    @unique @db.VarChar(100)
  isoCode      String    @unique @db.VarChar(10)
  description  String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  delFlag      Boolean   @default(false)

  createdBy    Int
  updatedBy    Int

  // ðŸ‘‡ Foreign key relations to User table
  createdByUser  m_user  @relation("LanguageCreatedBy", fields: [createdBy], references: [id])
  updatedByUser  m_user  @relation("LanguageUpdatedBy", fields: [updatedBy], references: [id])
  recipeDetails m_recipe_details[]

}

model m_food_type {
  id           Int       @id @default(autoincrement())
  name         String    @unique @db.VarChar(100)
  description  String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  delFlag      Boolean   @default(false)

  createdBy    Int
  updatedBy    Int

  // ðŸ‘‡ Foreign key relations to User table
  createdByUser  m_user  @relation("FoodTypeCreatedBy", fields: [createdBy], references: [id])
  updatedByUser  m_user  @relation("FoodTypeUpdatedBy", fields: [updatedBy], references: [id])
   // ðŸ‘‡ Reverse relation to Recipes
  recipes       m_recipe[]
}


model m_recipe {
  id             Int       @id @default(autoincrement())
  uuid           String    @unique @db.VarChar(100)
  cuisineId      Int
  categoryId     Int
  foodTypeId     Int
  regionalName   String?   @db.VarChar(255)
  imageUrl       String?   @db.VarChar(255)
  videoUrl       String?   @db.VarChar(255)
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  delFlag        Boolean   @default(false)

  createdBy      Int
  updatedBy      Int

  // ðŸ‘‡ Foreign key relations
  cuisine        m_cuisine   @relation(fields: [cuisineId], references: [id])
  category       m_category  @relation(fields: [categoryId], references: [id])
  foodType       m_food_type @relation(fields: [foodTypeId], references: [id])

  createdByUser  m_user      @relation("RecipeCreatedBy", fields: [createdBy], references: [id])
  updatedByUser  m_user      @relation("RecipeUpdatedBy", fields: [updatedBy], references: [id])

  // ðŸ‘‡ One-to-many relationship with recipe details
  details        m_recipe_details[]


}


model m_recipe_details {
  id            Int        @id @default(autoincrement())
  recipeId      Int
  languageId    Int
  name          String     @db.VarChar(255)
  instructions  String     @db.Text
  ingredients   String     @db.Text
  notes         String?    @db.Text
  createdAt     DateTime   @default(now())
  updatedAt     DateTime   @updatedAt
  delFlag       Boolean    @default(false)

  createdBy     Int
  updatedBy     Int

  // ðŸ‘‡ Foreign key relations
  recipe        m_recipe    @relation(fields: [recipeId], references: [id])
  language      m_language  @relation(fields: [languageId], references: [id])
  createdByUser m_user      @relation("RecipeDetailsCreatedBy", fields: [createdBy], references: [id])
  updatedByUser m_user      @relation("RecipeDetailsUpdatedBy", fields: [updatedBy], references: [id])
}




